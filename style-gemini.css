/* ==========================================================================
   1. FONT SETUP
   ========================================================================== */

@font-face {
  font-family: "Klee One";
  src: url("font/kleeone_regular.ttf") format("truetype");
  font-display: swap; /* Improves perceived performance */
}

@font-face {
  font-family: 'Noto Sans JP';
  src: url('font/NotoSansJP-VariableFont_wght.ttf') format('truetype');
  font-weight: 100;
  font-style: normal;
  font-display: swap; /* Improves perceived performance */
}

/* ==========================================================================
   2. ROOT VARIABLES (CUSTOM PROPERTIES)
   ========================================================================== */

:root {
  /* Colors */
  --clr-background: #000000;
  --clr-text-light: #ffffff;
  --clr-text-dark: #000000;
  --clr-text-subtle: #f2f2f2;
  --clr-accent-primary: #37b6ec;
  --clr-accent-secondary: #010f21;
  --clr-accent-tertiary: #3c1000; /* From header gradient */
  --clr-accent-neutral: #eeedf1; /* From header gradient */
  --clr-button-text: #fffaf6;
  --clr-modal-overlay: rgba(0, 0, 0, 0.9);
  --clr-modal-bg: #ffffff;
  --clr-modal-header-bg: #000000;
  --clr-modal-header-text: #ffffff;
  --clr-interactive-focus: var(--clr-accent-primary); /* For focus rings */
  --clr-link-light: var(--clr-text-light); /* Default link color */

  /* Gradients */
  --gradient-sidebar: linear-gradient(203deg, var(--clr-accent-primary) 0%, var(--clr-accent-secondary) 90%);
  --gradient-header-footer: linear-gradient(160deg, var(--clr-accent-neutral) 0%, var(--clr-accent-tertiary) 127%);
  --gradient-menu-button: linear-gradient(160deg, #f0eff3 0%, #0e0135 127%);
  --gradient-menu-button-small: linear-gradient(160deg, #f0eff3 0%, #0b0135 127%);
  --gradient-hidden-item: linear-gradient(130deg, #f4f3f7 0%, #1eaafc 85%, #3edfd7 100%);

  /* Fonts */
  --font-primary: "Klee One", cursive;
  --font-secondary: "Noto Sans JP", sans-serif; /* Added generic fallback */

  /* Typography (rem based for accessibility, clamp for fluidity) */
  --font-size-base: 1rem; /* Approx 16px by default */
  --line-height-base: 1.5;
  --font-size-sm: 0.875rem; /* ~14px */
  --font-size-xs: 0.75rem;  /* ~12px */
  --font-size-h1: clamp(1.75rem, 4vw, 3rem);
  --font-size-h2: clamp(1.5rem, 3.5vw, 2.7rem);
  --font-size-h3: clamp(1.3rem, 3vw, 2.5rem);
  --font-size-h4: clamp(1.15rem, 2.5vw, 2rem);
  --font-size-h5: clamp(1rem, 2vw, 1.5rem);
  --font-size-h6: clamp(0.875rem, 1.5vw, 1rem);
  --font-size-p: clamp(1rem, 2vw, 1.1rem);
  --font-size-credit: clamp(0.8rem, 1.1vw, 1rem);
  --font-size-credit-small: 0.8rem; /* Fixed rem size */

  /* Sizing & Spacing (rem for consistency, vw for main layout) */
  --spacing-unit: 0.25rem; /* Base unit (~4px) */
  --spacing-1: var(--spacing-unit);      /* ~4px */
  --spacing-2: calc(var(--spacing-unit) * 2); /* ~8px */
  --spacing-3: calc(var(--spacing-unit) * 3); /* ~12px */
  --spacing-4: calc(var(--spacing-unit) * 4); /* ~16px */
  --spacing-6: calc(var(--spacing-unit) * 6); /* ~24px */
  --spacing-8: calc(var(--spacing-unit) * 8); /* ~32px */

  --layout-margin: 0.2vw; /* Main container margin */
  --grid-sidebar-width: 9vw;
  --grid-gap-width: 3vw;
  --grid-content-width: calc(100% - var(--grid-sidebar-width) - var(--grid-gap-width)); /* Adjusted */
  --container-height-vw: 56.25vw; /* 16:9 aspect ratio */

  /* Borders & Shadows */
  --border-width-standard: 1px; /* Use px for crisp borders */
  --border-radius-sm: 0.15rem; /* Use rem for scalable radius */
  --border-radius-md: 0.5rem;
  --border-radius-lg: 0.8rem;
  --border-radius-round: 50%;
  --box-shadow-light: 0 1px 2px rgba(0, 0, 0, 0.3); /* Adjusted shadow */
  --box-shadow-medium: 0 2px 5px rgba(0, 0, 0, 0.4); /* Adjusted shadow */
  --box-shadow-heavy: 0 4px 10px rgba(0, 0, 0, 0.5); /* Adjusted shadow */
  --focus-ring-width: 2px;
  --focus-ring-offset: 2px;
  --focus-ring-color: rgba(55, 182, 236, 0.7); /* Semi-transparent focus */

  /* Transitions */
  --transition-duration: 0.2s;
  --transition-timing: ease-in-out;
  --transition-base: all var(--transition-duration) var(--transition-timing);

  /* Z-Indexes */
  --z-index-back: -1;
  --z-index-base: 1;
  --z-index-content: 10;
  --z-index-sidebar: 20;
  --z-index-modal-controls: 90;
  --z-index-modal: 100;
  --z-index-overlay: 80; /* Ensure overlay is below modal content */
}



html {
  font-size: 100%; /* Typically 16px, basis for rem units */
  line-height: var(--line-height-base);
  -webkit-text-size-adjust: 100%; /* Prevent font scaling in landscape on iOS */
}

body {
  background-color: var(--clr-background);
  color: var(--clr-text-light); /* Default text color */
  font-family: var(--font-primary);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  overflow: hidden; /* CAUTION: Prevents scrolling. Re-evaluate if content might overflow. */
}

img,
picture,
video,
canvas,
svg {
  display: block; /* Remove extra space below inline images */
  max-width: 100%;
  height: auto;
}

button,
input,
select,
textarea {
  font: inherit; /* Inherit font styles */
}

a {
  color: var(--clr-link-light);
  text-decoration: none; /* Remove default underline */
}

a:hover {
  text-decoration: underline; /* Add underline on hover for clarity */
}

/* ==========================================================================
   4. LAYOUT (#container & Grid)
   ========================================================================== */

#container {
  position: absolute;
  top: 0; right: 0; bottom: 0; left: 0;
  width: 100vw;
  height: var(--container-height-vw); /* Maintain 16:9 aspect ratio */
  max-height: 100vh; /* Prevent exceeding viewport height */
  max-width: 100%; /* Prevent exceeding viewport width */
  margin: var(--layout-margin);
  overflow: hidden;
  background-color: var(--clr-background);

  display: grid;
  grid-template-columns: var(--grid-sidebar-width) var(--grid-gap-width) auto; /* Use auto for content */
  grid-template-areas: "sidebar-left gap-left content-center";
  gap: 0; /* Explicitly no gap */
}

/* Grid Areas */
.gap-left { /* Use class selector, avoid #container qualification */
  grid-area: gap-left;
  background-color: var(--clr-background);
  z-index: var(--z-index-base);
}

.sidebar-left {
  grid-area: sidebar-left;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-between; /* Space out header, menu, footer */
  height: 100%;
  padding: var(--spacing-2);
  background-image: var(--gradient-sidebar);
  border-radius: var(--border-radius-sm);
  box-shadow: var(--box-shadow-light);
  z-index: var(--z-index-sidebar);
}

.content-center {
  grid-area: content-center;
  height: 100%;
  width: 100%;
  z-index: var(--z-index-content);
  position: relative; /* For absolute positioning inside */
  overflow: hidden; /* If content inside might overflow */
}

/* ==========================================================================
   5. TYPOGRAPHY
   ========================================================================== */

h1, h2, h3, h4, h5, h6 {
  font-weight: bold;
  line-height: 1.2; /* Tighter line height for headings */
  margin-bottom: var(--spacing-3);
}

h1 { font-size: var(--font-size-h1); }
h2 { font-size: var(--font-size-h2); }
h3 { font-size: var(--font-size-h3); }
h4 { font-size: var(--font-size-h4); }
h5 { font-size: var(--font-size-h5); }
h6 { font-size: var(--font-size-h6); }

p {
  font-size: var(--font-size-p);
  margin-bottom: var(--spacing-4);
}

.small-text {
  font-size: var(--font-size-sm);
  text-align: left;
}

small {
  font-size: var(--font-size-xs);
}

.credit-text {
  font-size: var(--font-size-credit);
  color: var(--clr-text-light);
  text-indent: var(--spacing-4); /* Indent using rem */
}

.credit-text-small {
  font-size: var(--font-size-credit-small);
  color: var(--clr-text-light);
  font-family: var(--font-secondary);
  margin-left: var(--spacing-1);
  text-indent: calc(-1 * var(--spacing-1)); /* Hanging indent */
  line-height: 1.2;
}

/* ==========================================================================
   6. COMPONENTS
   ========================================================================== */

/* --- Buttons --- */
.btn {
  display: inline-flex;
  justify-content: center;
  align-items: center;
  padding: var(--spacing-2) var(--spacing-4);
  font-family: var(--font-primary);
  font-weight: bold;
  border: none;
  border-radius: var(--border-radius-sm);
  cursor: pointer;
  text-align: center;
  text-decoration: none;
  transition: var(--transition-base);
  transition-property: background-color, transform, box-shadow; /* Specify transitioned properties */
  color: var(--clr-button-text); /* Default */
  background-color: transparent; /* Default */
}

/* Focus styles for accessibility */
.btn:focus {
  outline: none; /* Remove default outline */
}
.btn:focus-visible {
  outline: var(--focus-ring-width) solid var(--clr-interactive-focus);
  outline-offset: var(--focus-ring-offset);
  box-shadow: 0 0 0 var(--focus-ring-width) var(--focus-ring-color);
}

/* Button Variants */
.btn--gradient-menu {
  background-image: var(--gradient-menu-button);
  box-shadow: var(--box-shadow-heavy);
  color: var(--clr-button-text);
  object-fit: contain; /* If button contains an image */
}

.btn--gradient-menu-small {
  background-image: var(--gradient-menu-button-small);
  box-shadow: var(--box-shadow-heavy);
  color: #f8f6ff; /* Specific color from original */
  object-fit: contain;
}

/* Size Modifiers (Using vw for direct viewport scaling as per original design) */
.btn--size-menu-lg {
  height: 6.2vw;
  width: 6.2vw;
  padding: 0; /* Override padding for fixed size */
}
.btn--size-menu-sm {
  height: 3.1vw;
  width: 6.2vw;
  padding: 0;
}

/* Hover Effects */
.btn:hover {
  transform: scale(1.05); /* Consistent scale transform */
  box-shadow: var(--box-shadow-medium); /* Example subtle shadow change */
}
.btn--gradient-menu:hover {
  background-color: rgba(16, 3, 73, 0.884); /* Specific hover color */
  background-image: none; /* Remove gradient on hover? Or adjust gradient */
}
.btn--gradient-menu-small:hover {
  background-color: rgba(28, 6, 124, 0.884);
  background-image: none;
}

/* Link styled as button */
a.btn {
  /* Inherits .btn styles */
}

/* --- Icon/Image Buttons --- */
.icon-btn {
  display: inline-flex; /* Use flex for centering */
  justify-content: center;
  align-items: center;
  background-color: transparent;
  border: none;
  padding: 0;
  cursor: pointer;
  transition: var(--transition-base);
  transition-property: background-color, transform;
  border-radius: var(--border-radius-round); /* Default to round */
  box-shadow: var(--box-shadow-light);
}
.icon-btn img {
  display: block;
  object-fit: contain;
}

/* Focus */
.icon-btn:focus { outline: none; }
.icon-btn:focus-visible {
  outline: var(--focus-ring-width) solid var(--clr-interactive-focus);
  outline-offset: var(--focus-ring-offset);
  box-shadow: 0 0 0 var(--focus-ring-width) var(--focus-ring-color);
}

/* Variants */
.icon-btn--audio {
  max-height: 3vw; /* Retaining vw sizing */
  max-width: 3vw;
}
.icon-btn--audio-sm {
  max-height: 1.5vw;
  max-width: 1.5vw;
  border-radius: var(--border-radius-lg); /* Smaller radius */
}
.icon-btn--qr {
  max-height: 5.7vw;
  max-width: 5.7vw;
  border-radius: 0; /* Square */
}
.icon-btn--qr-lg {
  max-height: 10.5vw;
  max-width: 10.5vw;
  border-radius: 0;
}
.icon-btn--left-menu {
  height: 2.7vw;
  width: 2.7vw;
  background-color: #dfdefd; /* Specific background */
  border-radius: var(--border-radius-sm); /* Slight radius */
  box-shadow: var(--box-shadow-heavy);
}

/* Hover effects */
.icon-btn:hover {
  transform: scale(1.1); /* Consistent scaling */
}
.icon-btn--audio:hover { background-color: rgba(173, 196, 255, 0.884); }
.icon-btn--audio-sm:hover { background-color: rgba(181, 173, 255, 0.884); }
.icon-btn--qr:hover { background-color: rgba(189, 173, 255, 0.884); }
.icon-btn--qr-lg:hover { background-color: rgba(184, 173, 255, 0.884); }
.icon-btn--left-menu:hover { background-color: rgba(173, 178, 255, 0.884); transform: scale(1.15); }


/* --- Header / Footer --- */
.page-header,
.page-footer {
  background-image: var(--gradient-header-footer);
  box-shadow: var(--box-shadow-light);
  border-radius: var(--border-radius-sm);
  margin: var(--spacing-1);
  padding: var(--spacing-2) var(--spacing-4);
  text-align: center;
  /* Add display: flex if needed for alignment inside */
}

/* --- Sidebar Content --- */
.sidebar-header { /* Container for top elements in sidebar */
  width: 100%;
  /* Example fixed size */
  /* height: 6vw; */
  /* background: none; */
}
.sidebar-menu { /* Container for the main menu buttons */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center; /* Center items vertically if space allows */
  gap: var(--spacing-2);
  width: 100%;
  flex-grow: 1; /* Allow menu to take up remaining space */
  padding: var(--spacing-2) 0;
}
.sidebar-footer { /* Container for bottom elements in sidebar */
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: var(--spacing-2);
  /* background: none; */
}

/* --- Modal --- */
.modal-overlay { /* Renamed from .hidden-text */
  display: none; /* Hidden by default */
  position: fixed;
  inset: 0; /* Shortcut for top/right/bottom/left: 0 */
  z-index: var(--z-index-overlay);
  background-color: var(--clr-modal-overlay);
  padding: var(--spacing-8); /* Padding around modal content */
  overflow-y: auto; /* Allow scrolling if modal is too tall */

  /* Flex centering for modal content */
  display: flex;
  justify-content: center;
  align-items: center;
}

.modal-content {
  position: relative; /* For positioning close button */
  background-color: var(--clr-modal-bg);
  color: var(--clr-text-dark);
  width: 100%;
  max-width: 800px; /* Example max width */
  border-radius: var(--border-radius-md);
  box-shadow: var(--box-shadow-heavy);
  animation: animatetop var(--transition-duration) var(--transition-timing);
  overflow: hidden; /* Clip content to rounded corners */
}

@keyframes animatetop {
  from { transform: translateY(-50px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

.modal-header {
  padding: var(--spacing-3) var(--spacing-4);
  background-color: var(--clr-modal-header-bg);
  color: var(--clr-modal-header-text);
  position: relative; /* Context for buttons */
}

.modal-body {
  padding: var(--spacing-4);
  max-height: 70vh; /* Limit height, allow scroll */
  overflow-y: auto;
}

.modal-footer {
  padding: var(--spacing-3) var(--spacing-4);
  background-color: var(--clr-modal-header-bg);
  color: var(--clr-modal-header-text);
  text-align: right; /* Example footer alignment */
}

.modal-close {
  position: absolute;
  top: 50%; /* Center vertically */
  right: var(--spacing-4);
  transform: translateY(-50%); /* Precise vertical centering */
  background: none;
  border: none;
  padding: var(--spacing-1);
  font-size: 1.5rem; /* Use rem */
  font-weight: bold;
  line-height: 1;
  color: var(--clr-text-light); /* Match header text */
  cursor: pointer;
  transition: color var(--transition-duration);
}
.modal-close:hover,
.modal-close:focus {
  color: var(--clr-interactive-focus);
  text-decoration: none;
}
.modal-close:focus { outline: none; }
.modal-close:focus-visible { /* Add visual focus ring */
  color: var(--clr-interactive-focus);
  box-shadow: 0 0 0 var(--focus-ring-width) var(--focus-ring-color);
  border-radius: var(--border-radius-sm);
}

/* Modal Play Buttons */
.modal-play,
.modal-play-left {
 position: absolute;
 top: 50%;
 transform: translateY(-50%);
 background: none;
 border: none;
 padding: var(--spacing-1);
 font-size: 1.5rem; /* Match close button */
 font-weight: bold;
 color: var(--clr-text-light);
 cursor: pointer;
 transition: color var(--transition-duration);
}
.modal-play { right: calc(var(--spacing-4) + 2.5rem); } /* Position next to close */
.modal-play-left { left: var(--spacing-4); }

.modal-play:hover, .modal-play:focus,
.modal-play-left:hover, .modal-play-left:focus {
  color: var(--clr-interactive-focus);
  text-decoration: none;
}
.modal-play:focus, .modal-play-left:focus { outline: none; }
.modal-play:focus-visible, .modal-play-left:focus-visible {
  box-shadow: 0 0 0 var(--focus-ring-width) var(--focus-ring-color);
  border-radius: var(--border-radius-sm);
}


/* --- Lightbox/Slideshow --- */
.slideshow-container {
  position: relative; /* Context for navigation */
  height: 100%; /* Fill content area */
  width: 100%;
}

.mySlides {
  display: none; /* Hidden by default */
  height: 100%;
  width: 100%;
}
.mySlides img {
  width: 100%;
  height: 100%;
  object-fit: contain; /* Ensure image fits without distortion */
}
.mySlides--active { /* Use a class to show the active slide */
  display: block;
}

/* Navigation Buttons */
.slideshow-prev,
.slideshow-next {
  cursor: pointer;
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  width: auto;
  padding: var(--spacing-4);
  color: var(--clr-text-light);
  background-color: rgba(0, 0, 0, 0.3);
  font-weight: bold;
  font-size: 1.25rem; /* Use rem */
  transition: background-color var(--transition-duration) ease;
  border-radius: var(--border-radius-sm);
  user-select: none;
  -webkit-user-select: none;
  z-index: var(--z-index-modal-controls); /* Ensure above slide */
  border: none;
}
.slideshow-prev { left: var(--spacing-2); }
.slideshow-next { right: var(--spacing-2); }

.slideshow-prev:hover,
.slideshow-next:hover,
.slideshow-prev:focus,
.slideshow-next:focus {
  background-color: rgba(0, 0, 0, 0.7);
}
.slideshow-prev:focus, .slideshow-next:focus { outline: none; }
.slideshow-prev:focus-visible, .slideshow-next:focus-visible {
  outline: var(--focus-ring-width) solid var(--clr-interactive-focus);
  outline-offset: calc(-1 * var(--focus-ring-width)); /* Inset outline */
}

/* Number Text */
.slideshow-numbertext {
  color: var(--clr-text-subtle);
  font-size: var(--font-size-xs);
  padding: var(--spacing-2) var(--spacing-3);
  position: absolute;
  top: 0;
  left: 0;
  z-index: var(--z-index-modal-controls);
}

/* Caption */
.slideshow-caption-container {
  text-align: center;
  background-color: var(--clr-background);
  padding: var(--spacing-1) var(--spacing-4);
  color: var(--clr-text-light);
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  z-index: var(--z-index-modal-controls);
}

/* Thumbnails */
.slideshow-thumbnails {
  /* Add styles for thumbnail row if needed */
}
.slideshow-demo {
  opacity: 0.6;
  cursor: pointer;
  transition: opacity var(--transition-duration);
}
.slideshow-demo:hover,
.slideshow-demo--active { /* Class for active thumbnail */
  opacity: 1;
}


/* ==========================================================================
   7. UTILITY CLASSES
   ========================================================================== */

.flex-center {
  display: flex;
  justify-content: center;
  align-items: center;
}

.hidden {
  display: none !important; /* Utility to hide elements */
}

.visually-hidden { /* Hide visually but keep accessible to screen readers */
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

.cursor-pointer {
  cursor: pointer;
}

.clickable { /* Alias for cursor-pointer */
  cursor: pointer;
}

/* Float-based grid - consider replacing with modern CSS Grid/Flexbox */
.row::after {
  content: "";
  display: table;
  clear: both;
}
.column {
  float: left;
  width: 25%; /* Example */
  padding: 0 var(--spacing-2);
}

/* ==========================================================================
   8. MEDIA QUERIES
   ========================================================================== */

/* Portrait Orientation */
@media screen and (orientation: portrait) {
  /* --- IMPORTANT --- */
  /* Hiding the body makes the site unusable in portrait. */
  /* Provide a responsive layout OR show a message instead. */
  body {
    /* display: none; */ /* Avoid this */

    /* Example: Show a message overlay */
     overflow: hidden; /* Prevent scrolling */
  }
   body::before {
     content: "Please rotate your device to landscape mode for the best experience.";
     position: fixed;
     inset: 0;
     background-color: var(--clr-background);
     color: var(--clr-text-light);
     display: flex;
     justify-content: center;
     align-items: center;
     text-align: center;
     padding: var(--spacing-8);
     font-size: var(--font-size-lg);
     z-index: 9999;
   }
   #container {
     display: none; /* Hide main content when showing message */
   }
}

/* Example: Adjustments for smaller landscape screens */
@media screen and (orientation: landscape) and (max-width: 768px) {
  :root {
    /* Optionally adjust fluid typography ranges or spacing */
    /* --font-size-h1: clamp(1.5rem, 6vw, 2.5rem); */
    /* --spacing-unit: 0.2rem; */
  }

  /* Example: Make sidebar narrower */
  /* #container {
    grid-template-columns: 7vw 2vw auto;
  } */
}

/* Example: Adjustments for very large screens */
@media screen and (orientation: landscape) and (min-width: 1920px) {
  :root {
    /* Increase base font size slightly? */
    /* font-size: 110%; */
  }
}